



<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NFT RPG Game - Solana Fixed (Global)</title>
<style>
  body {
    background-color: burlywood;
    font-family: "Times New Roman", serif;
    color: black;
    text-align: center;
  }
  button {
    border: none;
    border-radius: 15px;
    padding: 8px 15px;
    margin: 5px;
    background-color: white;
    color: black;
    font-weight: bold;
    cursor: pointer;
  }
  #messages { margin-top: 10px; min-height: 24px; font-weight: bold; }
  #gameArea { margin-top: 20px; display: none; }
</style>
</head>
<body>

<h1>NFT RPG Game - Solana</h1>

<button id="connectBtn">Connect Wallet</button>
<p>Wallet: <span id="walletAddress">not connected</span></p>
<div id="messages"></div>

<button id="startGameBtn" style="display:none;">Start Game</button>

<div id="gameArea">
  <p>Player Health: <span id="playerHealth">100</span></p>
  <p>Enemy Health: <span id="enemyHealth">100</span></p>
  <button onclick="attack()">Attack</button>
  <button onclick="reset()">Reset</button>
</div>

<!-- ✅ Load the global Solana SDK -->
<script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.78.0/lib/index.iife.min.js"></script>

<script>
let walletAddress = null;
const connectBtn = document.getElementById("connectBtn");
const walletSpan = document.getElementById("walletAddress");
const startBtn = document.getElementById("startGameBtn");
const msg = document.getElementById("messages");

function showMessage(text, color="black") {
  msg.innerText = text;
  msg.style.color = color;
}

async function connectWallet() {
  try {
    const provider = window.solana;
    if (!provider || !provider.isPhantom) {
      showMessage("Phantom Wallet not found! Install Phantom.", "red");
      return;
    }

    const resp = await provider.connect();
    walletAddress = resp.publicKey.toString();
    walletSpan.innerText = walletAddress;
    showMessage("✅ Wallet connected!");
    connectBtn.style.display = "none";
    startBtn.style.display = "inline-block";

    // ✅ You can use Solana connection here
    const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl('devnet'));
    console.log("Connected to Solana devnet:", connection);
  } catch (err) {
    console.error("Wallet connection error:", err);
    showMessage("❌ Connection failed. Check Phantom or refresh.", "red");
  }
}

connectBtn.addEventListener("click", connectWallet);

startBtn.addEventListener("click", () => {
  document.getElementById("gameArea").style.display = "block";
  startBtn.style.display = "none";
  showMessage("Game started!");
});

// ===== Simple Game Logic =====
let playerHealth = 100;
let enemyHealth = 100;

function attack() {
  const dmg = Math.floor(Math.random() * 15) + 5;
  enemyHealth -= dmg;
  document.getElementById("enemyHealth").innerText = enemyHealth;
  showMessage(`You attacked enemy for ${dmg}!`);
  if (enemyHealth <= 0) {
    showMessage("🎉 You won!");
  }
}

function reset() {
  playerHealth = 100;
  enemyHealth = 100;
  document.getElementById("playerHealth").innerText = playerHealth;
  document.getElementById("enemyHealth").innerText = enemyHealth;
  showMessage("Game reset.");
}
</script>
</body>
</html>